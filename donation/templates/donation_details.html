{% extends 'base.html' %}
{% block content %}
<html>
  <head>
    <title>DonaWaste - Donation Details</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">


  

    
  </head>
  <body>

    <div class="container mt-4">
        <h2 class="mb-4">Donation Details</h2>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">{{donation.title}}</h5>
                <p class="card-text">
                    <strong>Donator:</strong>
                    {% if donation.donator %}
                      {{donation.donator.username}}
                    {% else %}
                      Anonymous
                    {% endif %}
                    <br>
                    <strong>Status:</strong> 
                    {% if donation.status == True %}
                        <span class="badge badge-success">Open</span>
                    {% else %}
                        <span class="badge badge-danger">Closed</span>
                    {% endif %}
                    <br>
                    <strong>Primary Key:</strong> {{donation.pk}}<br>
                    <strong>Category:</strong>
                    {% if donation.category %}
                        {{donation.category.name}}
                    {% else %}
                        Unspecified
                    {% endif %}
                    <br>
                    <strong>Date and Time Created:</strong> {{donation.datetime_created}}<br>
                    <strong>Weight (grams):</strong> {{donation.weight_grams}}<br>
                    <strong>Address:</strong> {{donation.address}}<br>
                    <strong>Description:</strong>
                    {% if donation.description %}
                        {{donation.description}}
                    {% else %}
                        <em>There is no description for this donation.</em>
                    {% endif %}
                </p>
            </div>
        </div>

        {% if donation.donator == logged_user %}
        <div class="text-center my-4">
            <a href="{% url 'donation:edit_existing_donation' donation.pk %}" class="btn btn-primary">Edit Donation</a>
            <a href="" class="btn btn-danger">Close Donation</a>
        </div>
        {% endif %}
    </div>

    <!--Maps Percobaan!!-->
    <div id="googleMap" style="width:100%;height:400px;"></div>

    <script>
      function myMap() {
        var mapProp = {
          center: new google.maps.LatLng(-6.1692651, 106.7865613),
          zoom: 18,
        };
        var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
        var marker = new google.maps.Marker({position: { lat: -6.1692651, lng: 106.7865613 }});
      
        marker.setMap(map);
        
        // This event listener calls addMarker() when the map is clicked.
        google.maps.event.addListener(map, 'click', function(event) {
          // Call function to add a new marker
          addMarker(event.latLng, map);
        });
      
        // Array to hold the markers
        var markers = [];
      
        // Adds a marker to the map and push to the array.
        function addMarker(location, map) {
          // If there's already a marker, remove it from the map
          if(markers.length !== 0) {
            markers[0].setMap(null);
            markers.pop();
          }
      
          // Create new marker
          var newMarker = new google.maps.Marker({
            position: location,
            map: map
          });
      
          // Push the new marker to the array
          markers.push(newMarker);
      
          // Add info window
          var infowindow = new google.maps.InfoWindow({
            content: 'Latitude: ' + location.lat() +
            '<br>Longitude: ' + location.lng()
          });
          infowindow.open(map,newMarker);
        }
      }
      </script>
      
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDR71Bdem7SpTRwVK1YBa3tNsBGDPkWTUg&callback=myMap"></script>
      

<!-- Include Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  </body>
{% endblock content %}
</html>
